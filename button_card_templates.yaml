  # !toggle word-wrap

  #################################################
  #                                               #
  #                     BASE                      #
  #                                               #
  #################################################

  base:
    aspect_ratio: 1/1
    show_state: false
    show_icon: false
    tap_action:
      action: toggle
      haptic: light
    styles:
      grid:
        - display: flex
        - flex-direction: column-reverse
        - justify-content: space-between
        - text-align: left
        - align-items: flex-start
      name:
        - display: block
        - white-space: normal
        - padding: 0 14px 5px 14px
        - line-height: 1.2
        - width: calc(100% - 28px)
      card:
        - font-weight: 400
        - border: 2px solid
        - border-color: >
            [[[ return (entity.state === 'on' || entity.state === 'home') ? 'rgba(255, 255, 255, 0.2)' : 'transparent'; ]]]
        - background-color: >
            [[[ return (entity.state === 'on' || entity.state === 'home') ? 'rgba(255, 255, 255, 0.025)' : 'var( --ha-card-background, var(--card-background-color, white) )'; ]]]
        

  #################################################
  #                                               #
  #                    CIRCLE                     #
  #                                               #
  #################################################

  circle:
    custom_fields:
      circle: >
        [[[
          if (entity.state === 'on') {
            const input = variables.circle_input;
            const radius = 20.5;
            const circumference = radius * 2 * Math.PI;
            return `
              <svg viewBox="0 0 50 50">
                <style>
                  circle {
                    transform: rotate(-90deg);
                    transform-origin: 50% 50%;
                    stroke-dasharray: ${circumference};
                    stroke-dashoffset: ${circumference - input / 100 * circumference};
                  }
                  tspan {
                    font-size: 10px;
                  }
                </style>
                <circle cx="25" cy="25" r="${radius}" stroke="#b2b2b2" stroke-width="2" fill="none" />
                <text x="50%" y="54%" fill="#8d8e90" font-size="14" text-anchor="middle" alignment-baseline="middle" dominant-baseline="middle">${input}<tspan font-size="10">%</tspan></text>
              </svg>
            `;
          }
        ]]]
    styles:
      custom_fields:
        circle: &person
          - top: 14px
          - right: 16px
          - width: 45px
          - position: absolute

  #################################################
  #                                               #
  #                    LOADER                     #
  #                                               #
  #################################################

  loader:
    custom_fields:
      loader: >
        [[[
          if (states[entity.entity_id.replace(entity.entity_id.split('.')[0], 'input_boolean')].state === 'on') {
            return '<img src="/local/loader.svg" width="100%">';
          }
        ]]]
    styles:
      custom_fields:
        loader:
          - top: 3%
          - left: 60%
          - width: 3.7vw
          - position: absolute
          - opacity: 0.6
          - filter: >
              [[[ return entity.state === 'off' ? 'invert(1)' : 'none'; ]]]

  #################################################
  #                                               #
  #                     LIGHT                     #
  #                                               #
  #################################################

  light:
    template:
      - base
    hold_action:
      action: fire-dom-event
      browser_mod:
        command: popup
        title: >
          [[[ return entity.attributes.friendly_name ]]]
        card:
          type: entities
          entities:
            - type: custom:light-popup-card
              entity: >
                [[[ return entity.entity_id ]]]
              icon: none
              fullscreen: false
              brightnessWidth: 130px
              brightnessHeight: 360px
              borderRadius: 1.7em
              sliderColor: '#c7c7c7'
              sliderTrackColor: rgba(25, 25, 25, 0.9)
            - type: custom:hui-element
              card_type: horizontal-stack
              card_mod:
                style: >
                  #root {
                    justify-content: center;
                    margin-top: 2em;
                  }
              cards:
                - type: custom:button-card
                  styles:
                    card:
                      - background: '#d8d9e1'
                  tap_action:
                    action: call-service
                    service: light.turn_on
                    service_data:
                      entity_id: >
                        [[[ return entity.entity_id ]]]
                      color_temp: 153
                  template: color_light
                - type: custom:button-card
                  styles:
                    card:
                      - background: '#d5b08d'
                  tap_action:
                    action: call-service
                    service: light.turn_on
                    service_data:
                      entity_id: >
                        [[[ return entity.entity_id ]]]
                      color_temp: 326
                  template: color_light
            - type: custom:hui-element
              card_type: horizontal-stack
              card_mod:
                style: >
                  #root {
                    justify-content: center;
                    margin-bottom: 1em;
                  }
              cards:
                - type: custom:button-card
                  styles:
                    card: 
                      - background: '#ce944b'
                  tap_action:
                    action: call-service
                    service: light.turn_on
                    service_data:
                      entity_id: >
                        [[[ return entity.entity_id ]]]
                      color_temp: 500
                  template: color_light
                #- type: custom:button-card
                #  styles:
                #    card:
                #      [background: 'radial-gradient(circle, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 80%), 
                #      conic-gradient(rgb(120, 39, 230), rgb(230, 34, 231), rgb(228, 5, 136), rgb(228, 25, 25), 
                #      rgb(229, 105, 30), rgb(232, 226, 46), rgb(125, 230, 41), rgb(52, 232, 40), rgb(51, 231, 92), 
                #      rgb(52, 232, 224), rgb(32, 125, 229), rgb(18, 39, 229), rgb(120, 39, 230))']
                #  tap_action:
                #    action: fire-dom-event
                #    browser_mod:
                #      command: popup
                #      title: >
                #        [[[ return entity.attributes.friendly_name ]]]
                #      card:
                #        type: custom:light-entity-card
                #        entity: >
                #          [[[ return entity.entity_id ]]]
                #        brightness: true
                #        color_temp: true
                #        full_width_sliders: false
                #        hide_header: true
                #        show_slider_percent: true
                #        smooth_color_wheel: true
                #        persist_features: true
                #        consolidate_entities: true
                #  template: color_light


  #################################################
  #                                               #
  #                 POPUP BUTTONS                 #
  #                                               #
  #################################################

  icon_name:
    size: 1.4em
    color: '#9da0a2'
    styles:
      grid:
        - grid-template-areas: '"i n"'
        - grid-column-gap: 0.3em
      card:
        - color: '#9da0a2'
        - border-radius: 0.6em
        - padding: 1em 1.4em 1em 1.2em
        - width: 100%
        - font-size: 1.06em
        - font-weight: 500
        - letter-spacing: 0.015em
        - background: '#FFFFFF10'

  icon_only:
    color: '#9da0a2'
    styles:
      card:
        - color: '#9da0a2'
        - border-radius: 0.6em
        - width: 4em
        - height: 3.7em
        - background: '#FFFFFF10'

  color_light:
    styles:
      card:
        - border-radius: 50%
        - height: 4em
        - width: 4em
        - margin: 4px

  #################################################
  #                                               #
  #                     ICONS                     #
  #                                               #
  #################################################

  icon_shade:
    styles:
      custom_fields:
        icon_shade:
          - height: 50px
          - margin: 5px 0 0 5px
    custom_fields:
      icon_shade: >
        [[[
          const state = entity.state === 'on' ? 'animate' : null;
          return `
            <svg viewBox="0 0 50 50" style="height:100%">
              <style>
                @keyframes animate {
                  0% {
                    transform: scale(0.85);
                  }
                  20% {
                    transform: scale(1.1);
                  }
                  40% {
                    transform: scale(0.95);
                  }
                  60% {
                    transform: scale(1.03);
                  }
                  80% {
                    transform: scale(0.97);
                  }
                  100% {
                    transform: scale(1);
                  }
                }
                .animate {
                  animation: animate 0.8s;
                  transform-origin: center;
                }
              </style>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M24.9 18.1587C24.3477 18.1587 23.9 18.6064 23.9 19.1587V41.3755H21.7202C21.1679 41.3755 20.7202 41.8232 20.7202 42.3755V42.5755C20.7202 43.1278 21.1679 43.5755 21.7202 43.5755H28.2799C28.8322 43.5755 29.2799 43.1278 29.2799 42.5755V42.3755C29.2799 41.8232 28.8322 41.3755 28.2799 41.3755H26.1V19.1587C26.1 18.6064 25.6523 18.1587 25.1 18.1587H24.9Z" fill="#4F5152"/>
              <path class="${state}" fill="var(--button-card-light-color-no-temperature)" d="M19.2775 6.6411C19.495 6.05192 20.0566 5.66064 20.6846 5.66064H28.7162C29.3223 5.66064 29.8689 6.02546 30.1014 6.58524L34.6447 17.5229C35.055 18.5107 34.3291 19.5983 33.2595 19.5983H16.6462C15.6021 19.5983 14.8774 18.5582 15.2391 17.5788L19.2775 6.6411Z" fill="#9DA0A2"/>
              </svg>
          `;
        ]]]

  icon_work_lamp:
    styles:
      custom_fields:
        work_lamp:
          - height: 50px
          - margin: 2px 0px 0px 12px
    custom_fields:
      work_lamp: >
        [[[
          const state = entity.state === 'on' ? 'animate' : null;
          return `
            <svg viewBox="0 0 50 50" style="height:100%">
              <style>
                @keyframes animate {
                  0% {
                    transform: scale(0.85);
                  }
                  20% {
                    transform: scale(1.1);
                  }
                  40% {
                    transform: scale(0.95);
                  }
                  60% {
                    transform: scale(1.03);
                  }
                  80% {
                    transform: scale(0.97);
                  }
                }
                .animate {
                  animation: animate 0.8s;
                  transform-origin: center;
                }
              </style>
              <path class="${state}" fill="var(--button-card-light-color-no-temperature)" d="M26.4703 16.9644C26.1488 15.3828 27.4145 11.7258 28.7605 10.5509C30.1065 9.37605 34.4408 6.79424 39.5716 8.62641C44.7024 10.4586 38.1065 26.9047 33.617 25.3015C29.1276 23.6984 26.7918 18.546 26.4703 16.9644Z" fill="#9DA0A2"/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M12.1684 9.09739C12.3286 8.56885 12.887 8.27026 13.4155 8.43047L27.498 12.6991C28.0265 12.8593 28.3251 13.4177 28.1649 13.9462L28.1069 14.1376C27.9466 14.6661 27.3883 14.9647 26.8598 14.8045L17.6793 12.0218L17.6793 42.5952C17.6793 42.5953 17.6793 42.5954 17.6793 42.5955H20.0574C20.6097 42.5955 21.0574 43.0432 21.0574 43.5955V43.7955C21.0574 44.3477 20.6097 44.7955 20.0574 44.7955H13.4585C12.9062 44.7955 12.4585 44.3477 12.4585 43.7955V43.5955C12.4585 43.0432 12.9062 42.5955 13.4585 42.5955H15.4793C15.4793 42.5954 15.4793 42.5953 15.4793 42.5952L15.4793 11.428C15.4793 11.4037 15.4802 11.3796 15.4819 11.3557L12.7773 10.5359C12.2488 10.3757 11.9502 9.81732 12.1104 9.28879L12.1684 9.09739Z" fill="#4F5152"/>
              </svg>
          `;
        ]]]

  icon_led:
    styles:
      custom_fields:
        icon_led:
          - height: 50px
          - margin: 2px 0px 0px 12px
    custom_fields:
      icon_led: >
        [[[
          const state = entity.state === 'on' ? 'animate' : null;
          return `
            <svg viewBox="0 0 50 50" style="height:100%">
              <style>
                @keyframes animate {
                  0% {
                    transform: scale(0.85);
                  }
                  20% {
                    transform: scale(1.1);
                  }
                  40% {
                    transform: scale(0.95);
                  }
                  60% {
                    transform: scale(1.03);
                  }
                  80% {
                    transform: scale(0.97);
                  }
                }
                .animate {
                  animation: animate 0.8s;
                  transform-origin: center;
                }
              </style>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M42.0098 14.2317L40.4396 12.1688L42.1907 10.8528C42.6322 10.521 42.7211 9.89411 42.3894 9.4526L42.3768 9.43592C42.045 8.99441 41.4181 8.90546 40.9766 9.23725L39.2155 10.5607L39.0587 10.3547C38.7242 9.91523 38.0968 9.83016 37.6573 10.1647L7.98861 32.7482C7.54915 33.0827 7.46408 33.7102 7.79859 34.1496L8.01514 34.4341L6.33594 35.696C5.89443 36.0278 5.80548 36.6547 6.13728 37.0962L6.14981 37.1129C6.48161 37.5544 7.10849 37.6433 7.55 37.3116L9.23917 36.0422L10.8094 38.1051L9.19788 39.3161C8.75637 39.6479 8.66742 40.2748 8.99921 40.7163L9.01175 40.733C9.34354 41.1745 9.97043 41.2635 10.4119 40.9317L12.0363 39.711C12.381 40.0927 12.9667 40.1527 13.3834 39.8356L43.0521 17.252C43.4916 16.9175 43.5766 16.29 43.2421 15.8506L43.2338 15.8397L45.0526 14.4729C45.4941 14.1411 45.5831 13.5142 45.2513 13.0727L45.2388 13.056C44.907 12.6145 44.2801 12.5256 43.8386 12.8574L42.0098 14.2317Z" fill="#4F5152"/>
              <path class="${state}" fill="var(--button-card-light-color-no-temperature)" d="M37.1955 13.0188C37.635 12.6843 38.2624 12.7693 38.5969 13.2088L40.3477 15.5089C40.6822 15.9483 40.5971 16.5757 40.1577 16.9103L14.0385 36.7919C13.5991 37.1264 12.9717 37.0414 12.6371 36.6019L10.8864 34.3018C10.5518 33.8624 10.6369 33.2349 11.0764 32.9004L37.1955 13.0188Z" fill="#9DA0A2"/>
              </svg>
          `;
        ]]]

  icon_ceiling:
    styles:
      custom_fields:
        icon_ceiling:
          - height: 50px
          - margin: 2px 0px 0px 12px
    custom_fields:
      icon_ceiling: >
        [[[
          const state = entity.state === 'on' ? 'animate' : null;
          return `
            <svg viewBox="0 0 50 50" style="height:100%">
              <style>
                @keyframes animate {
                  0% {
                    transform: scale(0.85);
                  }
                  20% {
                    transform: scale(1.1);
                  }
                  40% {
                    transform: scale(0.95);
                  }
                  60% {
                    transform: scale(1.03);
                  }
                  80% {
                    transform: scale(0.97);
                  }
                }
                .animate {
                  animation: animate 0.8s;
                  transform-origin: center;
                }
              </style>
              <rect x="23.8999" y="8.95801" width="2.2" height="17.71" rx="1" fill="#4F5152"/>
              <path class="${state}" fill="var(--button-card-light-color-no-temperature)"  d="M22.6794 24.6488C22.961 24.2548 23.4155 24.021 23.8998 24.021H26.0285C26.5109 24.021 26.9638 24.253 27.2457 24.6445L35.1217 35.5821C35.8362 36.5743 35.1271 37.9587 33.9045 37.9587H16.0827C14.8625 37.9587 14.1529 36.5792 14.8624 35.5865L22.6794 24.6488Z" fill="#9DA0A2"/>
              </svg>
          `;
        ]]] 

  icon_ceiling_double:
    styles:
      custom_fields:
        icon_ceiling_double:
          - height: 50px
          - margin: 2px 0px 0px 12px
    custom_fields:
      icon_ceiling_double: >
        [[[
          const state = entity.state === 'on' ? 'animate' : null;
          return `
            <svg viewBox="0 0 50 50" style="height:100%">
              <style>
                @keyframes animate {
                  0% {
                    transform: scale(0.85);
                  }
                  20% {
                    transform: scale(1.1);
                  }
                  40% {
                    transform: scale(0.95);
                  }
                  60% {
                    transform: scale(1.03);
                  }
                  80% {
                    transform: scale(0.97);
                  }
                }
                .animate {
                  animation: animate 0.8s;
                  transform-origin: center;
                }
              </style>
              <rect x="15.5801" y="3.24756" width="2.6097" height="21.008" rx="1" fill="#4F5152"/>
              <rect x="33.2698" y="3.24756" width="2.6097" height="18.2018" rx="1" fill="#4F5152"/>
              <path class="${state}" fill="var(--button-card-light-color-no-temperature)" fill-rule="evenodd" clip-rule="evenodd" d="M16.1709 23.1333C15.5158 23.1333 14.9847 23.6644 14.9847 24.3195V27.1339C14.9847 27.137 14.9847 27.1401 14.9847 27.1433C13.05 29.1386 10.333 32.5646 10.333 36.0697C10.333 41.5127 14.674 45.4317 15.4779 45.4317C15.4779 45.4317 15.4779 46.7529 16.8849 46.7529C18.2919 46.7529 18.2919 45.4317 18.2919 45.4317C19.0958 45.4317 23.4368 41.5127 23.4368 36.0697C23.4368 32.5487 20.695 29.1073 18.7587 27.1161V24.3195C18.7587 23.6644 18.2276 23.1333 17.5725 23.1333H16.1709Z" fill="#9DA0A2"/>
              <path class="${state}" fill="var(--button-card-light-color-no-temperature)" fill-rule="evenodd" clip-rule="evenodd" d="M33.8738 19.5391C33.2186 19.5391 32.6875 20.0702 32.6875 20.7253V23.307C30.8093 24.0568 29.4822 25.8925 29.4822 28.0383C29.4822 30.8507 31.7621 33.1306 34.5745 33.1306C37.3869 33.1306 39.6668 30.8507 39.6668 28.0383C39.6668 25.8926 38.3397 24.0569 36.4616 23.3071V20.7253C36.4616 20.0702 35.9305 19.5391 35.2753 19.5391H33.8738Z" fill="#9DA0A2"/>
              </svg>
          `;
        ]]]           

  icon_panel:
    styles:
      custom_fields:
        icon_panel:
          - height: 50px
          - margin: 2px 0px 0px 12px
    custom_fields:
      icon_panel: >
        [[[
          const state = entity.state === 'on' ? 'animate' : null;
          return `
            <svg viewBox="0 0 50 50" style="height:100%">
              <style>
                @keyframes animate {
                  0% {
                    transform: scale(0.85);
                  }
                  20% {
                    transform: scale(1.1);
                  }
                  40% {
                    transform: scale(0.95);
                  }
                  60% {
                    transform: scale(1.03);
                  }
                  80% {
                    transform: scale(0.97);
                  }
                }
                .animate {
                  animation: animate 0.8s;
                  transform-origin: center;
                }
              </style>
              <path d="M9.24709 13.6686C9.03125 14.3161 9.51322 14.9848 10.1958 14.9848H40.8043C41.4869 14.9848 41.9688 14.3161 41.753 13.6686L41.6778 13.443C41.5417 13.0347 41.1596 12.7593 40.7291 12.7593H10.271C9.84053 12.7593 9.45839 13.0347 9.32228 13.443L9.24709 13.6686Z" fill="#4F5152"/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M41.866 16.9789C42.0308 16.3454 41.5528 15.7271 40.8983 15.7271H10.0669C9.42332 15.7271 8.94732 16.3261 9.09274 16.953L13.6194 36.4668C13.7246 36.92 14.1283 37.2408 14.5936 37.2408H35.821C36.2763 37.2408 36.6741 36.9332 36.7888 36.4926L41.866 16.9789ZM38.8311 18.6773C38.996 18.0438 38.5179 17.4254 37.8633 17.4254H13.1028C12.4589 17.4254 11.9828 18.0251 12.1288 18.6522L15.8813 34.769C15.9867 35.2218 16.3903 35.5423 16.8553 35.5423H33.6691C34.1244 35.5423 34.5222 35.2347 34.6368 34.7941L38.8311 18.6773Z" fill="#4F5152"/>
              <path class="${state}" fill="var(--button-card-light-color-no-temperature)" d="M13.5665 19.9347C13.4104 19.3041 13.8876 18.6943 14.5372 18.6943H36.4269C37.0876 18.6943 37.5667 19.3237 37.3908 19.9606L33.6405 33.5395C33.5207 33.973 33.1263 34.2733 32.6766 34.2733H17.8996C17.4399 34.2733 17.0394 33.9598 16.9289 33.5136L13.5665 19.9347Z" fill="#9DA0A2"/>
              </svg>
          `;
        ]]]
